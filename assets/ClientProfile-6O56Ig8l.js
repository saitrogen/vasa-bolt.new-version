import{d as W,O as G,i as u,h as J,n as K,c as l,a as e,p as Q,L as X,g as E,t as i,b as y,v as _,f as U,y as p,F as I,q as Y,B as Z,s as h,H as tt,o,P as et}from"./index-BFEQWBay.js";import{_ as st}from"./Modal.vue_vue_type_script_setup_true_lang-DrVpGJl3.js";const at={class:"max-w-5xl mx-auto space-y-6 p-6"},lt={class:"card flex flex-col md:flex-row items-center md:items-stretch"},ot={class:"flex flex-col items-center justify-center md:w-1/4 p-6 border-r border-slate-200/80 dark:border-slate-800"},nt={class:"w-20 h-20 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-3xl text-slate-500 dark:text-slate-400 mb-2"},it={key:0},rt={key:1},dt={class:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1"},ut={class:"text-xs text-slate-500 dark:text-slate-400"},mt={class:"text-slate-700 dark:text-slate-300"},ct={class:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4 p-6"},vt={key:1,class:"text-slate-900 dark:text-slate-100"},pt={key:1,class:"text-slate-900 dark:text-slate-100"},xt={key:1,class:"text-slate-900 dark:text-slate-100"},bt={class:"md:col-span-2"},ft={key:1,class:"text-slate-900 dark:text-slate-100 whitespace-pre-line"},kt={class:"flex flex-col justify-between p-6 md:w-32 md:border-l border-slate-200/80 dark:border-slate-800 items-end md:items-center"},yt={key:1,class:"flex flex-wrap justify-end md:justify-center gap-2 mt-2 md:mt-0"},_t={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},gt={class:"card card-content flex flex-col items-center"},Ct={class:"text-2xl text-slate-900 dark:text-slate-100 font-bold"},ht={class:"card card-content flex flex-col items-center"},wt={class:"text-2xl text-primary-600 dark:text-primary-400 font-bold"},At={class:"card"},St={class:"flex border-b border-slate-200 dark:border-slate-700"},Tt={key:0,class:"p-6"},$t={class:"flex gap-4 mb-4"},Dt={class:"w-full text-left"},Bt={class:"py-3"},Vt={class:"py-3"},jt={class:"py-3"},Nt={class:"py-3"},Et={key:1,class:"p-6"},Ut={class:"mt-6 flex justify-end gap-4"},It=W({__name:"ClientProfile",setup(Mt){const M=G(),P=X(),g=M.params.id,r=u(null),d=u(!1),n=u({}),c=u(!1),{addToast:w}=tt(),x=u([]),b=u({totalAppointments:0,upcomingAppointments:0}),m=u("today"),v=u("appointments"),A=async()=>{const{data:s,error:t}=await h.from("clients").select("*").eq("id",g).single();!t&&s&&(r.value=s,n.value={...s})},q=async()=>{const{data:s,error:t}=await h.from("appointments").select("*, barber:barbers(*)").eq("client_id",g).order("start_time",{ascending:!1});if(!t&&s){x.value=s;const f=new Date().toISOString().slice(0,10);b.value.totalAppointments=s.length,b.value.upcomingAppointments=s.filter(k=>k.start_time>f).length}},L=()=>{c.value=!0},O=async()=>{const s={name:n.value.name,phone_number:n.value.phone_number,email:n.value.email,notes:n.value.notes},{error:t}=await h.from("clients").update(s).eq("id",g);c.value=!1,t?(console.error("Error updating client:",t),w({title:"Error",message:"Failed to save client profile.",type:"error"})):(w({title:"Success",message:"Client profile saved.",type:"success"}),d.value=!1,A())},F=()=>{n.value={...r.value},d.value=!1},S=s=>{const t="px-4 py-3 text-sm font-medium focus:outline-none";return v.value===s?`${t} text-slate-900 dark:text-slate-100 border-b-2 border-primary-500`:`${t} text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200`},C=s=>{const t="px-3 py-1 text-sm font-medium rounded-lg";return m.value===s?`${t} bg-slate-200/50 dark:bg-slate-700/50 text-slate-900 dark:text-slate-100`:`${t} text-slate-500 dark:text-slate-400 hover:bg-slate-200/50 dark:hover:bg-slate-700/50`},R=J(()=>{const s=new Date().toISOString().slice(0,10);return m.value==="today"?x.value.filter(t=>t.start_time.startsWith(s)):m.value==="previous"?x.value.filter(t=>t.start_time<s):x.value.filter(t=>t.start_time>s)});function z(s){return new Date(s).toLocaleDateString(void 0,{month:"short",day:"numeric"})}function T(s){return new Date(s).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}const H=()=>P.push({name:"Clients"});return K(()=>{A(),q()}),(s,t)=>{var f,k,$,D,B,V,j;return o(),l(I,null,[e("div",at,[e("button",{onClick:H,class:"flex items-center text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 text-sm font-medium mb-2 btn-ghost"},t[12]||(t[12]=[e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M15 19l-7-7 7-7"})],-1),E(" Back to Clients ")])),e("div",lt,[e("div",ot,[e("div",nt,[r.value?(o(),l("span",rt,i((f=r.value.name)==null?void 0:f.charAt(0)),1)):(o(),l("span",it,"?"))]),e("div",dt,i(((k=r.value)==null?void 0:k.name)||"Name"),1),e("div",ut,[t[13]||(t[13]=E("Client ID: ")),e("span",mt,i((($=r.value)==null?void 0:$.id)||"—"),1)])]),e("div",ct,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Name",-1)),d.value?y((o(),l("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value.name=a),class:"input"},null,512)),[[_,n.value.name]]):(o(),l("div",vt,i(((D=r.value)==null?void 0:D.name)||"—"),1))]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Phone",-1)),d.value?y((o(),l("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=a=>n.value.phone_number=a),class:"input"},null,512)),[[_,n.value.phone_number]]):(o(),l("div",pt,i(((B=r.value)==null?void 0:B.phone_number)||"—"),1))]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Email",-1)),d.value?y((o(),l("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.email=a),class:"input"},null,512)),[[_,n.value.email]]):(o(),l("div",xt,i(((V=r.value)==null?void 0:V.email)||"—"),1))]),e("div",bt,[t[17]||(t[17]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Notes",-1)),d.value?y((o(),l("textarea",{key:0,"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.notes=a),class:"textarea"},null,512)),[[_,n.value.notes]]):(o(),l("div",ft,i(((j=r.value)==null?void 0:j.notes)||"—"),1))])]),e("div",kt,[d.value?(o(),l("div",yt,[e("button",{onClick:L,class:"btn btn-primary"},"Save"),e("button",{onClick:F,class:"btn btn-outline"},"Cancel")])):(o(),l("button",{key:0,onClick:t[4]||(t[4]=a=>d.value=!0),class:"btn btn-secondary mt-2 md:mt-0"},"Edit"))])]),e("div",_t,[e("div",gt,[t[18]||(t[18]=e("div",{class:"text-slate-500 dark:text-slate-400 mb-2 text-xs"},"Total Appointments",-1)),e("div",Ct,i(b.value.totalAppointments),1)]),e("div",ht,[t[19]||(t[19]=e("div",{class:"text-slate-500 dark:text-slate-400 mb-2 text-xs"},"Upcoming Appointments",-1)),e("div",wt,i(b.value.upcomingAppointments),1)])]),e("div",At,[e("div",St,[e("button",{class:p(S("appointments")),onClick:t[5]||(t[5]=a=>v.value="appointments")},"Appointments",2),e("button",{class:p(S("collections")),onClick:t[6]||(t[6]=a=>v.value="collections")},"Collection",2)]),v.value==="appointments"?(o(),l("div",Tt,[e("div",$t,[e("button",{class:p(C("previous")),onClick:t[7]||(t[7]=a=>m.value="previous")},"Previous",2),e("button",{class:p(C("today")),onClick:t[8]||(t[8]=a=>m.value="today")},"Today",2),e("button",{class:p(C("upcoming")),onClick:t[9]||(t[9]=a=>m.value="upcoming")},"Upcoming",2)]),e("table",Dt,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"border-b border-slate-200/80 dark:border-slate-700/80 text-xs text-slate-500 dark:text-slate-400"},[e("th",{class:"py-3 font-medium"},"Date"),e("th",{class:"py-3 font-medium"},"Start Time"),e("th",{class:"py-3 font-medium"},"End Time"),e("th",{class:"py-3 font-medium"},"Barber")])],-1)),e("tbody",null,[(o(!0),l(I,null,Y(R.value,a=>{var N;return o(),l("tr",{key:a.id,class:"border-b border-slate-200/80 dark:border-slate-700/80"},[e("td",Bt,i(z(a.start_time)),1),e("td",Vt,i(T(a.start_time)),1),e("td",jt,i(T(a.end_time)),1),e("td",Nt,i(((N=a.barber)==null?void 0:N.name)||"—"),1)])}),128))])])])):U("",!0),v.value==="collections"?(o(),l("div",Et,t[21]||(t[21]=[e("p",{class:"text-slate-500 dark:text-slate-400"},"Collections data for this client is not available yet.",-1)]))):U("",!0)])]),Q(st,{"is-open":c.value,onClose:t[11]||(t[11]=a=>c.value=!1),title:"Confirm Save"},{default:Z(()=>[t[22]||(t[22]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Are you sure you want to save these changes?",-1)),e("div",Ut,[e("button",{onClick:t[10]||(t[10]=a=>c.value=!1),class:"btn btn-outline"},"Cancel"),e("button",{onClick:O,class:"btn btn-primary"},"Save Changes")])]),_:1,__:[22]},8,["is-open"])],64)}}}),Lt=et(It,[["__scopeId","data-v-65a0f3d7"]]);export{Lt as default};
