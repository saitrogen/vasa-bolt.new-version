import{d as S,i as d,r as V,n as F,c as l,a as e,p as c,g as T,e as b,f as C,F as h,q as w,B as j,s as f,H as q,t as k,b as B,v as D,w as O,o as i}from"./index-BFEQWBay.js";import{_ as A}from"./Modal.vue_vue_type_script_setup_true_lang-DrVpGJl3.js";import{r as H}from"./PlusIcon-NzFvHLfC.js";import{r as L}from"./PencilSquareIcon-DVxBfWgh.js";import{r as U}from"./TrashIcon-D-UsiS2K.js";const z={class:"flex justify-between items-center mb-4"},G={class:"card"},I={class:"divide-y divide-slate-200 dark:divide-slate-700"},J={class:"font-medium"},K=["onClick"],P=["onClick"],Q={key:1,class:"p-4 text-center text-slate-500"},R={class:"flex justify-end gap-3 pt-4"},W=["disabled"],X=S({__name:"ExpenseCategoryManager",setup($){const{addToast:n}=q(),r=d([]),u=d(!1),m=d(!1),g=d(!1),p=d(!1),x=()=>({id:null,name:""}),a=V(x()),v=async()=>{u.value=!0;const{data:t,error:s}=await f.from("expense_categories").select("*").order("name");s?n({type:"error",title:"Error",message:"Could not fetch categories."}):r.value=t||[],u.value=!1},_=(t=null)=>{t?(p.value=!0,a.id=t.id,a.name=t.name):(p.value=!1,Object.assign(a,x())),g.value=!0},y=()=>{g.value=!1},E=async()=>{if(!a.name.trim()){n({type:"error",title:"Validation Error",message:"Category name cannot be empty."});return}m.value=!0;try{if(p.value&&a.id){const{error:t}=await f.from("expense_categories").update({name:a.name}).eq("id",a.id);if(t)throw t;n({type:"success",title:"Success",message:"Category updated."})}else{const{error:t}=await f.from("expense_categories").insert({name:a.name});if(t)throw t;n({type:"success",title:"Success",message:"Category created."})}await v(),y()}catch(t){n({type:"error",title:"Error",message:t.message||"Failed to save category."})}finally{m.value=!1}},N=async t=>{if(!confirm(`Are you sure you want to delete the category "${t.name}"? This might affect existing expenses.`))return;const{error:s}=await f.from("expense_categories").delete().eq("id",t.id);s?n({type:"error",title:"Error",message:s.message||"Failed to delete category."}):(n({type:"success",title:"Success",message:"Category deleted."}),await v())};return F(()=>{v()}),(t,s)=>(i(),l("div",null,[e("div",z,[s[3]||(s[3]=e("h3",{class:"text-xl font-semibold"},"Expense Categories",-1)),e("button",{onClick:s[0]||(s[0]=o=>_()),class:"btn btn-primary"},[c(b(H),{class:"w-4 h-4 mr-2"}),s[2]||(s[2]=T(" New Category "))])]),e("div",G,[e("ul",I,[u.value?(i(),l(h,{key:0},w(3,o=>e("li",{key:o,class:"p-4"},s[4]||(s[4]=[e("div",{class:"animate-pulse flex space-x-4"},[e("div",{class:"flex-1 space-y-2 py-1"},[e("div",{class:"h-2 bg-slate-200 dark:bg-slate-700 rounded w-1/3"})])],-1)]))),64)):C("",!0),(i(!0),l(h,null,w(r.value,o=>(i(),l("li",{key:o.id,class:"p-4 flex justify-between items-center"},[e("p",J,k(o.name),1),e("div",null,[e("button",{onClick:M=>_(o),class:"btn btn-sm btn-ghost"},[c(b(L),{class:"w-5 h-5"})],8,K),e("button",{onClick:M=>N(o),class:"btn btn-sm btn-ghost text-red-500 hover:text-red-700"},[c(b(U),{class:"w-5 h-5"})],8,P)])]))),128)),!u.value&&r.value.length===0?(i(),l("li",Q," No expense categories found. ")):C("",!0)])]),c(A,{"is-open":g.value,title:p.value?"Edit Category":"New Category",onClose:y},{default:j(()=>[e("form",{onSubmit:O(E,["prevent"]),class:"space-y-4"},[e("div",null,[s[5]||(s[5]=e("label",{class:"label"},"Category Name",-1)),B(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>a.name=o),type:"text",class:"input",required:"",placeholder:"e.g. Office Supplies"},null,512),[[D,a.name]])]),e("div",R,[e("button",{type:"button",onClick:y,class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",disabled:m.value,class:"btn btn-primary"},k(m.value?"Saving...":"Save Category"),9,W)])],32)]),_:1},8,["is-open","title"])]))}}),Y={class:"space-y-6"},Z={class:"card p-4"},ne=S({__name:"Settings",setup($){return(n,r)=>(i(),l("div",Y,[r[0]||(r[0]=e("h1",{class:"text-2xl font-bold text-slate-900 dark:text-slate-100"},"Settings",-1)),e("div",Z,[c(X)])]))}});export{ne as default};
