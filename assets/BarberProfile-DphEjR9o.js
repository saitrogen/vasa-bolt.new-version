import{d as tt,O as et,i as m,h as st,n as at,c as l,a as e,p as lt,L as ot,g as L,t as r,b as c,v,f as W,y as k,F as $,q as H,B as nt,s as w,H as rt,o,P as dt}from"./index-BFEQWBay.js";import{_ as it}from"./Modal.vue_vue_type_script_setup_true_lang-DrVpGJl3.js";const ut={class:"max-w-5xl mx-auto space-y-6 p-6"},mt={class:"card flex flex-col md:flex-row items-center md:items-stretch"},ct={class:"flex flex-col items-center justify-center md:w-1/4 p-6 border-r border-slate-200/80 dark:border-slate-800"},vt={class:"w-20 h-20 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-3xl text-slate-500 dark:text-slate-400 mb-2"},xt={key:0},pt={key:1},bt={class:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1"},_t={class:"text-xs text-slate-500 dark:text-slate-400"},kt={class:"text-slate-700 dark:text-slate-300"},ft={class:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4 p-6"},yt={key:1,class:"text-slate-900 dark:text-slate-100"},gt={key:1,class:"text-slate-900 dark:text-slate-100"},ht={key:1,class:"text-slate-900 dark:text-slate-100"},Ct={key:1,class:"text-slate-900 dark:text-slate-100"},wt={class:"md:col-span-2"},St={key:1,class:"text-slate-900 dark:text-slate-100"},$t={class:"flex flex-col justify-between p-6 md:w-32 md:border-l border-slate-200/80 dark:border-slate-800 items-end md:items-center"},Tt={key:1,class:"flex flex-wrap justify-end md:justify-center gap-2 mt-2 md:mt-0"},Vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Bt={class:"card card-content"},Dt={key:1,class:"text-slate-900 dark:text-slate-100 mb-4"},At={key:3,class:"text-slate-900 dark:text-slate-100"},Ut={class:"card card-content"},Et={key:1,class:"text-slate-900 dark:text-slate-100 mb-4"},Nt={key:3,class:"text-slate-900 dark:text-slate-100"},Pt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},jt={class:"card card-content flex flex-col items-center"},It={class:"text-2xl text-slate-900 dark:text-slate-100 font-bold"},Ft={class:"card card-content flex flex-col items-center"},Mt={class:"text-2xl text-green-600 dark:text-green-500 font-bold"},Ot={class:"card card-content flex flex-col items-center"},qt={class:"text-2xl text-slate-900 dark:text-slate-100 font-bold"},Lt={class:"card"},Wt={class:"flex border-b border-slate-200 dark:border-slate-700"},Ht={key:0,class:"p-6"},Rt={class:"flex gap-4 mb-4"},zt={class:"w-full text-left"},Gt={class:"py-3"},Jt={class:"py-3"},Kt={class:"py-3"},Qt={class:"py-3"},Xt={key:1,class:"p-6"},Yt={class:"flex gap-4 mb-4"},Zt={class:"w-full text-left"},te={class:"py-3"},ee={class:"py-3 text-green-600 dark:text-green-500 font-semibold"},se={class:"mt-6 flex justify-end gap-4"},ae=tt({__name:"BarberProfile",setup(le){const R=et(),z=ot(),g=R.params.id,d=m(null),i=m(!1),a=m({}),f=m(!1),{addToast:T}=rt(),h=m([]),S=m([]),x=m({todayAppointments:0,todayCollection:0,monthlyCollection:0}),p=m("today"),y=m("appointments"),V=async()=>{const{data:n,error:t}=await w.from("barbers").select("*").eq("id",g).single();!t&&n&&(d.value=n,a.value={...n})},G=async()=>{const{data:n,error:t}=await w.from("appointments").select("*, client:clients(*)").eq("barber_id",g).order("start_time",{ascending:!1});if(!t&&n){h.value=n;const b=new Date().toISOString().slice(0,10);x.value.todayAppointments=n.filter(u=>u.start_time.startsWith(b)).length}},J=async()=>{const{data:n,error:t}=await w.from("daily_collections").select("*").eq("barber_id",g).order("collection_date",{ascending:!1});if(!t&&n){S.value=n.filter(u=>u.collection_date===new Date().toISOString().slice(0,10)),x.value.todayCollection=S.value.reduce((u,_)=>u+_.total_amount_manually_entered,0);const b=new Date().toISOString().slice(0,7);x.value.monthlyCollection=n.filter(u=>u.collection_date.startsWith(b)).reduce((u,_)=>u+_.total_amount_manually_entered,0)}},K=()=>{f.value=!0},Q=async()=>{const n={name:a.value.name,phone_number_work:a.value.phone_number_work,phone_number_home:a.value.phone_number_home,email:a.value.email,home_address:a.value.home_address,visa_number:a.value.visa_number,visa_expiry_date:a.value.visa_expiry_date,passport_number:a.value.passport_number,passport_expiry_date:a.value.passport_expiry_date},{error:t}=await w.from("barbers").update(n).eq("id",g);f.value=!1,t?(T({title:"Error",message:"Failed to save barber profile.",type:"error"}),console.error("Error updating barber:",t)):(T({title:"Success",message:"Barber profile saved.",type:"success"}),i.value=!1,V())},X=()=>{a.value={...d.value},i.value=!1},B=n=>{const t="px-4 py-3 text-sm font-medium focus:outline-none";return y.value===n?`${t} text-slate-900 dark:text-slate-100 border-b-2 border-primary-500`:`${t} text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200`},C=n=>{const t="px-3 py-1 text-sm font-medium rounded-lg";return p.value===n?`${t} bg-slate-200/50 dark:bg-slate-700/50 text-slate-900 dark:text-slate-100`:`${t} text-slate-500 dark:text-slate-400 hover:bg-slate-200/50 dark:hover:bg-slate-700/50`},Y=st(()=>{const n=new Date().toISOString().slice(0,10);return p.value==="today"?h.value.filter(t=>t.start_time.startsWith(n)):p.value==="previous"?h.value.filter(t=>t.start_time<n):h.value.filter(t=>t.start_time>n)});function D(n){return new Date(n).toLocaleDateString(void 0,{month:"short",day:"numeric"})}function A(n){return new Date(n).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}const Z=()=>z.push({name:"Barbers"});return at(()=>{V(),G(),J()}),(n,t)=>{var b,u,_,U,E,N,P,j,I,F,M,O;return o(),l($,null,[e("div",ut,[e("button",{onClick:Z,class:"flex items-center text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 text-sm font-medium mb-2 btn-ghost"},t[17]||(t[17]=[e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M15 19l-7-7 7-7"})],-1),L(" Back to Barbers ")])),e("div",mt,[e("div",ct,[e("div",vt,[d.value?(o(),l("span",pt,r((b=d.value.name)==null?void 0:b.charAt(0)),1)):(o(),l("span",xt,"?"))]),e("div",bt,r(((u=d.value)==null?void 0:u.name)||"Name"),1),e("div",_t,[t[18]||(t[18]=L("Staff ID: ")),e("span",kt,r(((_=d.value)==null?void 0:_.id)||"—"),1)])]),e("div",ft,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Name",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.name=s),class:"input"},null,512)),[[v,a.value.name]]):(o(),l("div",yt,r(((U=d.value)==null?void 0:U.name)||"—"),1))]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Phone (Work)",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.phone_number_work=s),class:"input"},null,512)),[[v,a.value.phone_number_work]]):(o(),l("div",gt,r(((E=d.value)==null?void 0:E.phone_number_work)||"—"),1))]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Phone (Home)",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.phone_number_home=s),class:"input"},null,512)),[[v,a.value.phone_number_home]]):(o(),l("div",ht,r(((N=d.value)==null?void 0:N.phone_number_home)||"—"),1))]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Email",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.email=s),class:"input"},null,512)),[[v,a.value.email]]):(o(),l("div",Ct,r(((P=d.value)==null?void 0:P.email)||"—"),1))]),e("div",wt,[t[23]||(t[23]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Address",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.home_address=s),class:"input"},null,512)),[[v,a.value.home_address]]):(o(),l("div",St,r(((j=d.value)==null?void 0:j.home_address)||"—"),1))])]),e("div",$t,[i.value?(o(),l("div",Tt,[e("button",{onClick:K,class:"btn btn-primary"},"Save"),e("button",{onClick:X,class:"btn btn-outline"},"Cancel")])):(o(),l("button",{key:0,onClick:t[5]||(t[5]=s=>i.value=!0),class:"btn btn-secondary mt-2 md:mt-0"},"Edit"))])]),e("div",Vt,[e("div",Bt,[t[24]||(t[24]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Visa Number",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.visa_number=s),class:"input"},null,512)),[[v,a.value.visa_number]]):(o(),l("div",Dt,r(((I=d.value)==null?void 0:I.visa_number)||"—"),1)),t[25]||(t[25]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Visa Expiry",-1)),i.value?c((o(),l("input",{key:2,"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.visa_expiry_date=s),type:"date",class:"input"},null,512)),[[v,a.value.visa_expiry_date]]):(o(),l("div",At,r(((F=d.value)==null?void 0:F.visa_expiry_date)||"—"),1))]),e("div",Ut,[t[26]||(t[26]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Passport Number",-1)),i.value?c((o(),l("input",{key:0,"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.passport_number=s),class:"input"},null,512)),[[v,a.value.passport_number]]):(o(),l("div",Et,r(((M=d.value)==null?void 0:M.passport_number)||"—"),1)),t[27]||(t[27]=e("label",{class:"block text-slate-500 dark:text-slate-400 mb-1 text-xs"},"Passport Expiry",-1)),i.value?c((o(),l("input",{key:2,"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.passport_expiry_date=s),type:"date",class:"input"},null,512)),[[v,a.value.passport_expiry_date]]):(o(),l("div",Nt,r(((O=d.value)==null?void 0:O.passport_expiry_date)||"—"),1))])]),e("div",Pt,[e("div",jt,[t[28]||(t[28]=e("div",{class:"text-slate-500 dark:text-slate-400 mb-2 text-xs"},"Today's Appointments",-1)),e("div",It,r(x.value.todayAppointments),1)]),e("div",Ft,[t[29]||(t[29]=e("div",{class:"text-slate-500 dark:text-slate-400 mb-2 text-xs"},"Today's Collection",-1)),e("div",Mt,"$"+r(x.value.todayCollection.toFixed(2)),1)]),e("div",Ot,[t[30]||(t[30]=e("div",{class:"text-slate-500 dark:text-slate-400 mb-2 text-xs"},"Monthly Collection",-1)),e("div",qt,"$"+r(x.value.monthlyCollection.toFixed(2)),1)])]),e("div",Lt,[e("div",Wt,[e("button",{class:k(B("appointments")),onClick:t[10]||(t[10]=s=>y.value="appointments")},"Appointments",2),e("button",{class:k(B("collections")),onClick:t[11]||(t[11]=s=>y.value="collections")},"Collection",2)]),y.value==="appointments"?(o(),l("div",Ht,[e("div",Rt,[e("button",{class:k(C("previous")),onClick:t[12]||(t[12]=s=>p.value="previous")},"Previous",2),e("button",{class:k(C("today")),onClick:t[13]||(t[13]=s=>p.value="today")},"Today",2),e("button",{class:k(C("upcoming")),onClick:t[14]||(t[14]=s=>p.value="upcoming")},"Upcoming",2)]),e("table",zt,[t[31]||(t[31]=e("thead",null,[e("tr",{class:"border-b border-slate-200/80 dark:border-slate-700/80 text-xs text-slate-500 dark:text-slate-400"},[e("th",{class:"py-3 font-medium"},"Date"),e("th",{class:"py-3 font-medium"},"Start Time"),e("th",{class:"py-3 font-medium"},"End Time"),e("th",{class:"py-3 font-medium"},"Client")])],-1)),e("tbody",null,[(o(!0),l($,null,H(Y.value,s=>{var q;return o(),l("tr",{key:s.id,class:"border-b border-slate-200/80 dark:border-slate-700/80"},[e("td",Gt,r(D(s.start_time)),1),e("td",Jt,r(A(s.start_time)),1),e("td",Kt,r(A(s.end_time)),1),e("td",Qt,r(((q=s.client)==null?void 0:q.name)||"—"),1)])}),128))])])])):W("",!0),y.value==="collections"?(o(),l("div",Xt,[e("div",Yt,[e("button",{class:k(C("today"))},"Today",2)]),e("table",Zt,[t[32]||(t[32]=e("thead",null,[e("tr",{class:"border-b border-slate-200/80 dark:border-slate-700/80 text-xs text-slate-500 dark:text-slate-400"},[e("th",{class:"py-3 font-medium"},"Date"),e("th",{class:"py-3 font-medium"},"Amount")])],-1)),e("tbody",null,[(o(!0),l($,null,H(S.value,s=>(o(),l("tr",{key:s.id,class:"border-b border-slate-200/80 dark:border-slate-700/80"},[e("td",te,r(D(s.collection_date)),1),e("td",ee,"$"+r(s.total_amount_manually_entered.toFixed(2)),1)]))),128))])])])):W("",!0)])]),lt(it,{"is-open":f.value,onClose:t[16]||(t[16]=s=>f.value=!1),title:"Confirm Save"},{default:nt(()=>[t[33]||(t[33]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Are you sure you want to save these changes?",-1)),e("div",se,[e("button",{onClick:t[15]||(t[15]=s=>f.value=!1),class:"btn btn-outline"},"Cancel"),e("button",{onClick:Q,class:"btn btn-primary"},"Save Changes")])]),_:1,__:[33]},8,["is-open"])],64)}}}),re=dt(ae,[["__scopeId","data-v-ad45d19d"]]);export{re as default};
